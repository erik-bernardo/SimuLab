<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Voa-Palavra: O Jogo da Correspondência</title>
    <style>
        body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #70c5ce; }
        canvas { border: 1px solid #000; display: block; background-color: #70c5ce; }
        html, body { overflow: hidden; }
        /* Adiciona fonte pixelizada (opcional, mas legal para jogos retrô) */
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
    </style>
</head>
<body>
    <canvas id="flappyCanvas" width="320" height="480"></canvas>
    <script>
const canvas = document.getElementById('flappyCanvas');
const ctx = canvas.getContext('2d');

// --- NOVO: Carregamento da Sprite do Pássaro ---
const birdSprite = new Image();
let spriteLoaded = false;
birdSprite.onload = function() {
    spriteLoaded = true;
};
// *** MUDE ESTE CAMINHO PELO URL OU CAMINHO LOCAL DA SUA IMAGEM ***
// Exemplo de uma imagem online: birdSprite.src = 'https://i.imgur.com/example-bird.png';
birdSprite.src = 'caminho/para/sua/imagem-passaro.png'; 
// --- FIM NOVO ---


// --- DADOS DO JOGO (Banco de Sinônimos) ---
const bancoDePalavras = [
    // --- 5 Conjuntos Originais ---
    { chave: "ALEGRE", correto: "FELIZ", distrator: ["TRISTE", "RÁPIDO", "FRIO"] },
    { chave: "RÁPIDO", correto: "VELOZ", distrator: ["LENTO", "GORDU", "ROXO"] },
    { chave: "INÍCIO", correto: "COMEÇO", distrator: ["FIM", "MEIO", "PARADA"] },
    { chave: "BELO", correto: "BONITO", distrator: ["FEIO", "SUJO", "FORTE"] },
    { chave: "AMPLIAR", correto: "AUMENTAR", distrator: ["DIMINUIR", "PARAR", "SUBIR"] },

    // --- 60 NOVOS Conjuntos (Sinônimos) ---
    { chave: "CALMO", correto: "SERENO", distrator: ["AGITADO", "BRAVO", "PERTO"] },
    { chave: "BRILHO", correto: "ESPLENDOR", distrator: ["ESCURIDÃO", "FUMAÇA", "BARULHO"] },
    { chave: "LIVRE", correto: "SOLTO", distrator: ["PRESO", "VERDE", "LONGE"] },
    { chave: "GRANDE", correto: "ENORME", distrator: ["PEQUENO", "AZUL", "RARO"] },
    { chave: "CORRETO", correto: "CERTO", distrator: ["ERRADO", "DUVIDOSO", "LENTO"] },
    { chave: "FÁCIL", correto: "SIMPLES", distrator: ["DIFÍCIL", "COMPLEXO", "CLARO"] },
    { chave: "IDEIA", correto: "NOÇÃO", distrator: ["OBJETO", "FATO", "SONO"] },
    { chave: "JUNTAR", correto: "UNIR", distrator: ["SEPARAR", "QUEBRAR", "AFASTAR"] },
    { chave: "MUDAR", correto: "ALTERAR", distrator: ["MANTER", "FIXAR", "CRIAR"] },
    { chave: "NOVO", correto: "RECENTE", distrator: ["VELHO", "ANTIGO", "FORTE"] },
    { chave: "PAZ", correto: "TRANQUILIDADE", distrator: ["GUERRA", "CAOS", "BARULHO"] },
    { chave: "FRIO", correto: "DESANIMADO", distrator: ["GELADO", "FRIO", "PESADO"] },
    { chave: "SUBIR", correto: "ASCENDER", distrator: ["DESCER", "CAIR", "PARAR"] },
    { chave: "TERMINAR", correto: "FINALIZAR", distrator: ["COMEÇAR", "INICIAR", "PROLONGAR"] },
    { chave: "VERDADE", correto: "SINCERIDADE", distrator: ["MENTIRA", "FALSIDADE", "DUVIDA"] },
    { chave: "VIAGEM", correto: "JORNADA", distrator: ["PARADA", "ESTADIA", "VOLTA"] },
    { chave: "FORTE", correto: "POTENTE", distrator: ["FRACO", "FRÁGIL", "SUAVE"] },
    { chave: "COMER", correto: "ALIMENTAR", distrator: ["VENENOSO", "DURO", "MOLHADO"] },
    { chave: "ADVERSIDADE", correto: "PROBLEMA", distrator: ["FACILIDADE", "BEM", "ALEGRIA"] },
    { chave: "CONHECER", correto: "SABER", distrator: ["IGNORAR", "ESQUECER", "FALAR"] },
    { chave: "DESEJAR", correto: "QUERER", distrator: ["REJEITAR", "RECUSAR", "NEGAR"] },
    { chave: "ECONOMIZAR", correto: "POUPAR", distrator: ["GASTAR", "DEIXAR", "DURAR"] },
    { chave: "FALHAR", correto: "ERRAR", distrator: ["ACERTAR", "VENCER", "PERDER"] },
    { chave: "GENTIL", correto: "CORTÊS", distrator: ["RUDE", "BRUTO", "FORTE"] },
    { chave: "HABITAR", correto: "MORAR", distrator: ["SAIR", "PASSAR", "VISITAR"] },
    { chave: "IRADO", correto: "ENFURECIDO", distrator: ["CONTENTE", "CALMO", "LENTO"] },
    { chave: "JUSTO", correto: "ÍGREGRO", distrator: ["INJUSTO", "PARCIAL", "PESADO"] },
    { chave: "LÍMPIDO", correto: "CRISTALINO", distrator: ["SUJO", "TURVO", "VELHO"] },
    { chave: "MAGNÍFICO", correto: "EXCELENTE", distrator: ["RUIM", "COMUM", "PEQUENO"] },
    { chave: "NECESSÁRIO", correto: "ESSENCIAL", distrator: ["DISPENSÁVEL", "EXTRA", "VERDE"] },
    { chave: "OBSERVAR", correto: "NOTAR", distrator: ["IGNORAR", "FALAR", "PULAR"] },
    { chave: "PERMITIR", correto: "AUTORIZAR", distrator: ["PROIBIR", "IMPEDIR", "PARAR"] },
    { chave: "PROTEGER", correto: "DEFENDER", distrator: ["ATACAR", "ABANDONAR", "QUEBRAR"] },
    { chave: "REVELAR", correto: "MOSTRAR", distrator: ["ESCONDER", "GUARDAR", "MUDAR"] },
    { chave: "SÁBIO", correto: "CULTIVADO", distrator: ["IGNORANTE", "JOVEM", "PESSIMO"] },
    { chave: "SUCESSO", correto: "ÊXITO", distrator: ["FRACASSO", "DERROTA", "ERRO"] },
    { chave: "TEMOR", correto: "MEDO", distrator: ["CORAGEM", "ALEGRIA", "PAZ"] },
    { chave: "ÚNICO", correto: "EXCLUSIVO", distrator: ["COMUM", "MÚLTIPLO", "MISTO"] },
    { chave: "VENCEDOR", correto: "TRIUNFANTE", distrator: ["PERDEDOR", "DERROTADO", "TRISTE"] },
    { chave: "ZOMBAR", correto: "CAÇOAR", distrator: ["ELOGIAR", "RESPEITAR", "AMAR"] },
    { chave: "INDO", correto: "PARTINDO", distrator: ["FICANDO", "CHEGANDO", "VOLTANDO"] },
    { chave: "COMPLICADO", correto: "EMBARAÇADO", distrator: ["DESCOMPLICADO", "FÁCIL", "SIMPLES"] },
    { chave: "BARULHO", correto: "RUÍDO", distrator: ["SILÊNCIO", "PAZ", "CALMO"] },
    { chave: "CEDO", correto: "PRECOCEMENTE", distrator: ["TARDE", "DEPOIS", "NUNCA"] },
    { chave: "DÚVIDA", correto: "INCERTEZA", distrator: ["CERTEZA", "VERDADE", "FATO"] },
    { chave: "ELOGIO", correto: "LOUVOR", distrator: ["CRÍTICA", "ATAQUE", "ERRO"] },
    { chave: "FRACO", correto: "FRÁGIL", distrator: ["FORTE", "RESISTENTE", "GRANDE"] },
    { chave: "GRITARIA", correto: "BERRARIA", distrator: ["SUSSURRO", "SILÊNCIO", "PAZ"] },
    { chave: "HOMENAGEM", correto: "TRIBUTO", distrator: ["ATAQUE", "CRÍTICA", "PUNIR"] },
    { chave: "ILUMINAR", correto: "CLAREAR", distrator: ["ESURECER", "COBRIR", "APAGAR"] },
    { chave: "JOGAR", correto: "LANÇAR", distrator: ["PEGAR", "GUARDAR", "PARAR"] },
    { chave: "LAMENTAR", correto: "LASTIMAR", distrator: ["ALEGRAR", "COMEMORAR", "SORRIR"] },
    { chave: "MESTRE", correto: "PROFESSOR", distrator: ["ALUNO", "APRENDIZ", "INICIANTE"] },
    { chave: "NECESSIDADE", correto: "CARÊNCIA", distrator: ["ABUNDÂNCIA", "EXCESSO", "RIQUEZA"] },
    { chave: "OCULTAR", correto: "ESCONDER", distrator: ["MOSTRAR", "REVELAR", "EXPOR"] },
    { chave: "PARTILHAR", correto: "COMPARTILHAR", distrator: ["RETER", "GUARDAR", "COMPRAR"] },
    { chave: "RECLAMAR", correto: "QUEIXAR", distrator: ["ELOGIAR", "ACEITAR", "CONCORDAR"] },
    { chave: "SORRIR", correto: "RIR", distrator: ["CHORAR", "TRISTE", "GRITAR"] },
    { chave: "TREMOR", correto: "ABALO", distrator: ["FIRMEZA", "PAZ", "FORTE"] },
    { chave: "VALOR", correto: "PREÇO", distrator: ["VAZIO", "GRÁTIS", "ERRO"] },
    { chave: "PREJUDICAR", correto: "DANIFICAR", distrator: ["AJUDAR", "REPARAR", "LOUVAR"] },
    { chave: "ESQUECER", correto: "OLVIDAR", distrator: ["LEMBRAR", "REGISTRAR", "FALAR"] },
    { chave: "REPETIR", correto: "REITERAR", distrator: ["PARAR", "CALAR", "SILENCIAR"] },
    { chave: "CHEGAR", correto: "ATINGIR", distrator: ["SAIR", "PARTIR", "CAIR"] },
    { chave: "RESIDIR", correto: "MORAR", distrator: ["VISITAR", "VIAJAR", "PULAR"] },
    { chave: "DESISTIR", correto: "ABANDONAR", distrator: ["INSISTIR", "CONTINUAR", "COMEÇAR"] }
];

// --- Variáveis Globais ---
let gravity = 0.6;
let flapStrength = -7;
let blockSpeed = 1;
let blockWidth = 70; 
let blockHeight = 110; 
let paddingY = 10;
let blockFrequency = 450;

// --- Estado do Jogo ---
let bird;
let blocks = []; 
let score = 0;
let frames = 0;
let gameState = 'start'; 
let currentWordSet = null; 
const birdColor = '#1e75cc'; 
const groundColor = '#ded895';
const skyColor = '#70c5ce';
const groundHeight = 10;
const totalBlocks = 4;

// --- Objeto Bird (Função DRAW MODIFICADA) ---
function Bird() {
    this.x = 50;
    this.y = canvas.height / 2;
    this.width = 70; 
    this.height = 30;
    this.velocity = 0;

    this.draw = function() {
        // --- LÓGICA DE DESENHO COM SPRITE E ROTAÇÃO ---
        
        // Aplica rotação para simular o mergulho/subida, exceto se o jogo estiver parado (gameover)
        if (gameState !== 'gameover' && (spriteLoaded || gameState !== 'playing')) {
            ctx.save();
            
            // Ponto de Pivô: centro do pássaro
            const centerX = this.x + this.width / 2;
            const centerY = this.y + this.height / 2;
            ctx.translate(centerX, centerY);
            
            // Ângulo de rotação baseado na velocidade (limites)
            let angle = (this.velocity / 10) * (Math.PI / 4); // Ajuste a rotação (máximo 45 graus)
            if (angle > Math.PI / 2) angle = Math.PI / 2; // Limite rotação para baixo (90 graus)
            if (angle < -Math.PI / 4) angle = -Math.PI / 4; // Limite rotação para cima (-45 graus)
            ctx.rotate(angle);

            if (spriteLoaded) {
                // Desenha a imagem centrada no novo ponto (0, 0)
                ctx.drawImage(
                    birdSprite, 
                    -this.width / 2, 
                    -this.height / 2, 
                    this.width, 
                    this.height
                );
            } else {
                // Fallback (retângulo)
                ctx.fillStyle = birdColor;
                ctx.fillRect(-this.width / 2, -this.height / 2, this.width, this.height);
            }

            // Desenha a palavra chave (será rotacionada junto com o pássaro)
            ctx.fillStyle = 'white';
            ctx.font = "12px sans-serif";
            ctx.textAlign = "center";
            ctx.fillText(currentWordSet ? currentWordSet.chave : "", 0, 4);

            ctx.restore(); // Restaura o contexto original do canvas

        } else {
             // Desenho simples para a tela inicial ou se a sprite não carregar (sem rotação)
            ctx.fillStyle = birdColor;
            ctx.fillRect(this.x, this.y, this.width, this.height);
            
            ctx.fillStyle = 'white';
            ctx.font = "12px sans-serif";
            ctx.textAlign = "center";
            ctx.fillText(currentWordSet ? currentWordSet.chave : "", this.x + this.width / 2, this.y + this.height / 2 + 4);
        }
    }

    this.update = function() {
        this.velocity += gravity;
        this.y += this.velocity;

        if (this.y + this.height > canvas.height - groundHeight) {
            this.y = canvas.height - groundHeight - this.height;
            this.velocity = 0;
            gameOver("Você bateu no chão!");
        }
        if (this.y < 0) {
            this.y = 0;
            this.velocity = 0;
        }
    }

    this.flap = function() {
        if (gameState === 'playing') {
           this.velocity = flapStrength;
        } else if (gameState === 'start') {
            startGame();
            this.velocity = flapStrength;
        }
    }
}

// --- Bloco de Palavra (Mantida) ---
function WordBlock(word, isCorrect, yPos) {
    this.x = canvas.width;
    this.y = yPos;
    this.width = blockWidth;
    this.height = blockHeight; 
    this.word = word;
    this.isCorrect = isCorrect;
    this.collided = false;
    this.scored = false;   
    this.isColumnBase = false;
    
    this.draw = function() {
        ctx.fillStyle = this.isCorrect ? '#FFFFFF' : '#FFFFFF'; 
        if (this.scored) ctx.fillStyle = '#FFFFFF';
        
        ctx.fillRect(this.x, this.y, this.width, this.height);

        ctx.fillStyle = 'black';
        ctx.font = "16px sans-serif"; 
        ctx.textAlign = "center";
        ctx.fillText(this.word, this.x + this.width / 2, this.y + this.height / 2 + 4);

        ctx.strokeStyle = this.isCorrect ? '#FFFFFF' : '#FFFFFF'; 
        ctx.lineWidth = 2;
        ctx.strokeRect(this.x, this.y, this.width, this.height);
    }

    this.update = function() {
        this.x -= blockSpeed;
    }
}

// --- Lógica de Criação e Colisão de Blocos (Mantida) ---
function handleBlocks() {
    // 1. Geração de Nova Coluna 
    if (frames % blockFrequency === 0) {
        const novoSet = bancoDePalavras[Math.floor(Math.random() * bancoDePalavras.length)];
        currentWordSet = novoSet;
        
        let palavrasDaColuna = [novoSet.correto, ...novoSet.distrator];
        while (palavrasDaColuna.length < totalBlocks) {
            const allWords = bancoDePalavras.flatMap(set => set.distrator);
            const randomDistractor = allWords[Math.floor(Math.random() * allWords.length)];
            if (!palavrasDaColuna.includes(randomDistractor)) {
                 palavrasDaColuna.push(randomDistractor);
            }
        }
        palavrasDaColuna = palavrasDaColuna.slice(0, totalBlocks); 
        palavrasDaColuna.sort(() => Math.random() - 0.5);

        const startY = 0; 

        for (let i = 0; i < totalBlocks; i++) {
            const palavra = palavrasDaColuna[i];
            const isCorrect = (palavra === novoSet.correto);
            const yPos = startY + (i * (blockHeight + paddingY));
            
            const novoBloco = new WordBlock(palavra, isCorrect, yPos);
            if (isCorrect) {
                 novoBloco.isColumnBase = true;
            }
            blocks.push(novoBloco);
        }
    }

    // 2. Loop de Colisão, Pontuação e Movimento
    for (let i = blocks.length - 1; i >= 0; i--) {
        const block = blocks[i];
        block.update();
        block.draw();

        if (block.x + block.width < 0) {
            blocks.splice(i, 1);
            continue; 
        }

        const isColliding = (
            bird.x < block.x + block.width &&
            bird.x + bird.width > block.x &&
            bird.y < block.y + block.height &&
            bird.y + bird.height > block.y
        );

        if (isColliding) {
            if (block.isCorrect) {
                block.collided = true;
            } else {
                gameOver(`Você bateu em: ${block.word}! O correto era: ${currentWordSet.correto}`);
                return;
            }
        }
        
        // LÓGICA DE PONTUAÇÃO (APÓS PASSAGEM)
        if (block.isColumnBase && block.collided && !block.scored && block.x + block.width < bird.x) {
            score++;
            block.scored = true;
            removeBlockColumn(block.x);
        }
        
        // LÓGICA DE FALHA (Passagem sem Acerto)
        if (block.isColumnBase && !block.collided && block.x + block.width < bird.x) {
             gameOver(`Você perdeu a correspondência! Era: ${currentWordSet.correto}`);
             return;
        }

    }
}

function removeBlockColumn(xPos) {
    for (let i = blocks.length - 1; i >= 0; i--) {
        if (blocks[i].x === xPos) {
            blocks.splice(i, 1);
        }
    }
}

// --- Funções de Estado e Desenho (Mantidas) ---
function drawGround() {
    ctx.fillStyle = groundColor;
    ctx.fillRect(0, canvas.height - groundHeight, canvas.width, groundHeight);
}

function init() {
    bird = new Bird();
    blocks = [];
    score = 0;
    frames = 0;
    gameState = 'start';
    currentWordSet = { chave: "VOAR", correto: "", distrator: [] }; 
    drawStartScreen();
}

function startGame() {
    gameState = 'playing';
    blocks = []; 
    frames = 0; 
    score = 0; 
    bird.y = canvas.height / 2;
    bird.velocity = 0;
}

function gameOver(message) {
    if (gameState === 'gameover') return; 
    gameState = 'gameover';
    setTimeout(() => drawGameOverScreen(message), 50); 
}

function restartGame() {
    if (gameState === 'gameover') {
        init(); 
    }
}

function drawStartScreen() {
     clearCanvas();
     bird.draw(); 
     drawGround();
     ctx.fillStyle = "rgba(0, 0, 0, 0.5)";
     ctx.fillRect(0, 0, canvas.width, canvas.height);
     ctx.fillStyle = "white";
     ctx.font = "20px 'Press Start 2P', sans-serif"; 
     ctx.textAlign = "center";
     ctx.fillText("VOA-PALAVRA", canvas.width / 2, canvas.height / 2 - 40);
     ctx.font = "16px sans-serif";
     ctx.fillText("Toque para começar", canvas.width / 2, canvas.height / 2);
     ctx.fillText("(Busque o Sinônimo!)", canvas.width / 2, canvas.height / 2 + 30);
}

function drawGameOverScreen(message) {
     clearCanvas();
     blocks.forEach(block => block.draw());
     bird.draw();
     drawGround();

     ctx.fillStyle = "rgba(0, 0, 0, 0.7)";
     ctx.fillRect(0, 0, canvas.width, canvas.height);

     ctx.fillStyle = "red";
     ctx.font = "30px 'Press Start 2P', sans-serif";
     ctx.textAlign = "center";
     ctx.fillText("ERRO!", canvas.width / 2, canvas.height / 2 - 50);

     ctx.fillStyle = "yellow";
     ctx.font = "14px sans-serif";
     ctx.fillText(message, canvas.width / 2, canvas.height / 2 - 10);

     ctx.fillStyle = "white";
     ctx.font = "20px sans-serif";
     ctx.fillText(`Pontos: ${score}`, canvas.width / 2, canvas.height / 2 + 30);

     ctx.font = "16px sans-serif";
     ctx.fillText("Toque para reiniciar", canvas.width / 2, canvas.height / 2 + 70);
}

function drawScore() {
    ctx.fillStyle = "white";
    ctx.font = "30px 'Press Start 2P', sans-serif";
    ctx.textAlign = "center";
    ctx.strokeStyle = "black";
    ctx.lineWidth = 3;
    ctx.strokeText(score, canvas.width / 2, 50);
    ctx.fillText(score, canvas.width / 2, 50);
}

function clearCanvas() {
    ctx.fillStyle = skyColor;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
}

// --- Loop Principal ---
function gameLoop() {
    if (gameState === 'playing') {
        clearCanvas();
        frames++;

        handleBlocks(); 
        bird.update(); 
        bird.draw(); 
        drawGround(); 
        drawScore(); 
    } 
    
    requestAnimationFrame(gameLoop);
}

// --- Controles ---
function handleInput() {
    if (gameState === 'playing' || gameState === 'start') {
        bird.flap();
    } else if (gameState === 'gameover') {
        restartGame();
    }
}

canvas.addEventListener('click', handleInput);
document.addEventListener('keydown', function(event) {
    if (event.code === 'Space') {
        event.preventDefault(); 
        handleInput();
    }
});
canvas.addEventListener('touchstart', function(event) {
    event.preventDefault(); 
    handleInput();
});

// --- Iniciar ---
init(); 
requestAnimationFrame(gameLoop);
    </script>
</body>
</html>
