const QUIZ_DATA = [
    // -------------------------------------------------------------------
    // HIM (Masculino Singular) - Total 20
    // -------------------------------------------------------------------
    {
        icon: "‚öΩ", 
        scenario_pt: "The coach gave the soccer ball to **him**.", 
        scenario_interpretation: "The correct object pronoun for a single male is **HIM**.",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üìò", 
        scenario_pt: "The teacher handed the new book to **him**.", 
        scenario_interpretation: "The object pronoun after 'to' must be **HIM**.",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üëì", 
        scenario_pt: "The glasses belong to **him**. He left them on the table.", 
        scenario_interpretation: "The object pronoun after 'to' must be **HIM**.",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üéà", 
        scenario_pt: "Give the blue balloon to **him**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "‚åö", 
        scenario_pt: "He lost his watch. I must return **it** to **him**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üëï", 
        scenario_pt: "His mom bought a new shirt for **him**.", 
        scenario_interpretation: "The object pronoun after 'for' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üéÅ", 
        scenario_pt: "This gift is for **him**, he deserves it.", 
        scenario_interpretation: "The object pronoun after 'for' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üèÜ", 
        scenario_pt: "We all cheered for **him** when he won the race.", 
        scenario_interpretation: "The object pronoun after 'for' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üö≤", 
        scenario_pt: "His bicycle is broken. We need to fix **it** for **him**.", 
        scenario_interpretation: "The object pronoun after 'for' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üéß", 
        scenario_pt: "Someone found his headphones. Give **them** back to **him**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üç∞", 
        scenario_pt: "She saved a slice of cake for **him**.", 
        scenario_interpretation: "The object pronoun after 'for' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "ü•á", 
        scenario_pt: "The medal was awarded to **him** after the contest.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "ü™ë", 
        scenario_pt: "Move the chair closer to **him**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üó∫Ô∏è", 
        scenario_pt: "The explorer showed the old map to **him**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üî®", 
        scenario_pt: "Can you lend the hammer to **him**?", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üé£", 
        scenario_pt: "The fisherman lent his rod to **him** for a day.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üìù", 
        scenario_pt: "I will send the final report to **him** by email.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üëî", 
        scenario_pt: "The tailor finished the suit for **him**.", 
        scenario_interpretation: "The object pronoun after 'for' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üñºÔ∏è", 
        scenario_pt: "The museum curator pointed out the painting to **him**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },
    {
        icon: "üî¶", 
        scenario_pt: "Give the flashlight to **him** so he can see.", 
        scenario_interpretation: "The object pronoun after 'to' must be HIM (single male).",
        correct_answer: "HIM",
        answer_type: "HIM (Single Male)"
    },

    // -------------------------------------------------------------------
    // HER (Feminino Singular) - Total 20
    // -------------------------------------------------------------------
    {
        icon: "üéÄ", 
        scenario_pt: "The ribbon belongs to **her**. She wore it yesterday.", 
        scenario_interpretation: "The correct object pronoun for a single female is **HER**.",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üå∏", 
        scenario_pt: "The bouquet is for **her**. Someone sent it to her office.", 
        scenario_interpretation: "The object pronoun after 'for' must be **HER**.",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üé∏", 
        scenario_pt: "The guitar belongs to **her**. She is the band's singer.", 
        scenario_interpretation: "The object pronoun after 'to' must be **HER**.",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üëó", 
        scenario_pt: "The new dress was designed for **her**.", 
        scenario_interpretation: "The object pronoun after 'for' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üíé", 
        scenario_pt: "The precious gem belongs to **her**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "ü©∞", 
        scenario_pt: "I saw **her** practicing ballet yesterday.", 
        scenario_interpretation: "The object pronoun after the verb 'saw' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üíå", 
        scenario_pt: "The letter was addressed to **her**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üé§", 
        scenario_pt: "They gave the microphone to **her** to sing.", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üë†", 
        scenario_pt: "She loves those red shoes. Buy **them** for **her**.", 
        scenario_interpretation: "The object pronoun after 'for' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üõçÔ∏è", 
        scenario_pt: "The cashier gave the change to **her**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üéÇ", 
        scenario_pt: "We baked a birthday cake for **her**.", 
        scenario_interpretation: "The object pronoun after 'for' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üíç", 
        scenario_pt: "Her engagement ring is beautiful. Look at **it** with **her**.", 
        scenario_interpretation: "The object pronoun after 'with' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üçπ", 
        scenario_pt: "Bring a glass of juice to **her**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üé®", 
        scenario_pt: "The portrait was painted by **her** friend. It is for **her**.", 
        scenario_interpretation: "The object pronoun after 'for' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üó∫Ô∏è", 
        scenario_pt: "Can you show the way to **her**?", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üîë", 
        scenario_pt: "The landlady gave the apartment key to **her**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üíº", 
        scenario_pt: "The new job belongs to **her**. She earned **it**.", 
        scenario_interpretation: "The object pronoun after the verb 'earned' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üì±", 
        scenario_pt: "He is talking to **her** on the phone.", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üß∏", 
        scenario_pt: "The stuffed bear was a gift from **her** grandmother to **her**.", 
        scenario_interpretation: "The object pronoun after 'to' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },
    {
        icon: "üì∏", 
        scenario_pt: "The photographer took a picture of **her**.", 
        scenario_interpretation: "The object pronoun after 'of' must be HER (single female).",
        correct_answer: "HER",
        answer_type: "HER (Single Female)"
    },

    // -------------------------------------------------------------------
    // THEM (Plural) - Total 20
    // -------------------------------------------------------------------
    {
        icon: "üçé", 
        scenario_pt: "The apples are for **them**. They look hungry.", 
        scenario_interpretation: "The correct object pronoun for a plural group is **THEM**.",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üîë", 
        scenario_pt: "The boss gave the spare keys to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be **THEM**.",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üì∏", 
        scenario_pt: "I took a picture of **them** at the park.", 
        scenario_interpretation: "The object pronoun after 'of' must be **THEM**.",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üçï", 
        scenario_pt: "The waiter served pizza to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üé§", 
        scenario_pt: "The audience clapped loudly for **them**.", 
        scenario_interpretation: "The object pronoun after 'for' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üöå", 
        scenario_pt: "The bus driver waited for **them** to board.", 
        scenario_interpretation: "The object pronoun after 'for' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üå≥", 
        scenario_pt: "The tour guide showed the big tree to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üóûÔ∏è", 
        scenario_pt: "I will read the newspaper article to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üèÖ", 
        scenario_pt: "The coach gave the participation medals to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üèòÔ∏è", 
        scenario_pt: "The new houses belong to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üéÅ", 
        scenario_pt: "Christmas presents were bought for **them**.", 
        scenario_interpretation: "The object pronoun after 'for' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üí¨", 
        scenario_pt: "I overheard a conversation about **them**.", 
        scenario_interpretation: "The object pronoun after 'about' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "‚òî", 
        scenario_pt: "Bring the umbrellas with **them**, it's raining.", 
        scenario_interpretation: "The object pronoun after 'with' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üéüÔ∏è", 
        scenario_pt: "The tickets were given to **them** for the show.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üíª", 
        scenario_pt: "The IT department handed the new computers to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "‚úàÔ∏è", 
        scenario_pt: "I said goodbye to **them** at the airport.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üíµ", 
        scenario_pt: "The bank manager gave the cash to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "‚úâÔ∏è", 
        scenario_pt: "Please deliver the packages to **them**.", 
        scenario_interpretation: "The object pronoun after 'to' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üñºÔ∏è", 
        scenario_pt: "The students painted the mural for **them**.", 
        scenario_interpretation: "The object pronoun after 'for' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },
    {
        icon: "üõ†Ô∏è", 
        scenario_pt: "The construction workers brought tools with **them**.", 
        scenario_interpretation: "The object pronoun after 'with' must be THEM (plural group).",
        correct_answer: "THEM",
        answer_type: "THEM (Plural Group)"
    },

    // -------------------------------------------------------------------
    // IT (Animal/Coisa Singular) - Total 20
    // -------------------------------------------------------------------
    {
        icon: "ü¶¥", 
        scenario_pt: "The bone is for **it**. The dog has been a good boy.", 
        scenario_interpretation: "The correct object pronoun for a single animal or thing is **IT**.",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üì±", 
        scenario_pt: "Please turn **it** off during the class.", 
        scenario_interpretation: "The object pronoun replacing 'the phone' is **IT**.",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üéà", 
        scenario_pt: "The cat is playing with **it** (the ball).", 
        scenario_interpretation: "The object pronoun after 'with' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üê¶", 
        scenario_pt: "The bird is injured. We need to help **it**.", 
        scenario_interpretation: "The object pronoun after the verb 'help' must be IT (animal).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üå≥", 
        scenario_pt: "Don't cut down the tree, we need **it**.", 
        scenario_interpretation: "The object pronoun after the verb 'need' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üîë", 
        scenario_pt: "I can't find the key. Did you see **it**?", 
        scenario_interpretation: "The object pronoun after the verb 'see' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üé∏", 
        scenario_pt: "The band used **it** in their performance.", 
        scenario_interpretation: "The object pronoun after the verb 'used' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üìò", 
        scenario_pt: "The cover is damaged. Be careful with **it**.", 
        scenario_interpretation: "The object pronoun after 'with' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "‚òî", 
        scenario_pt: "Don't forget the umbrella. Bring **it** with you.", 
        scenario_interpretation: "The object pronoun after the verb 'bring' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "ü™ë", 
        scenario_pt: "Sit on **it** and wait for the show.", 
        scenario_interpretation: "The object pronoun after 'on' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "ü•ï", 
        scenario_pt: "The rabbit ate **it** quickly.", 
        scenario_interpretation: "The object pronoun after the verb 'ate' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üè†", 
        scenario_pt: "The house is old. They want to demolish **it**.", 
        scenario_interpretation: "The object pronoun after the verb 'demolish' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üí°", 
        scenario_pt: "The light bulb is broken. I need to replace **it**.", 
        scenario_interpretation: "The object pronoun after the verb 'replace' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üé§", 
        scenario_pt: "The singer dropped the microphone. Pick **it** up.", 
        scenario_interpretation: "The object pronoun after the verb 'pick up' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üö™", 
        scenario_pt: "Open **it** slowly. The hinges are loud.", 
        scenario_interpretation: "The object pronoun after the verb 'open' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üñºÔ∏è", 
        scenario_pt: "I don't like the painting. Hide **it** in the attic.", 
        scenario_interpretation: "The object pronoun after the verb 'hide' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üì¶", 
        scenario_pt: "The package is heavy. Help me lift **it**.", 
        scenario_interpretation: "The object pronoun after the verb 'lift' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üí∞", 
        scenario_pt: "The lottery winner kept **it** all to himself (the money).", 
        scenario_interpretation: "The object pronoun after the verb 'kept' must be IT (thing/money).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üöó", 
        scenario_pt: "The car is new. Drive **it** carefully.", 
        scenario_interpretation: "The object pronoun after the verb 'drive' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    },
    {
        icon: "üßä", 
        scenario_pt: "The ice cream is melting. Eat **it** now.", 
        scenario_interpretation: "The object pronoun after the verb 'eat' must be IT (thing).",
        correct_answer: "IT",
        answer_type: "IT (Animal/Thing)"
    }
];

// --- Mapa de Dicas (Manter em Portugu√™s para o Grim√≥rio/Dica) ---
const HINT_MAP = {
    "HIM": { emoji: "üë¶", pt: "ALVO: Masculino (Ele)" },
    "HER": { emoji: "üëß", pt: "ALVO: Feminino (Ela)" },
    "THEM": { emoji: "üë•", pt: "ALVO: Plural (Eles/Elas)" },
    "IT": { emoji: "üê∂", pt: "ALVO: Neutro (Animal/Coisa)" }
};

// Elementos DOM
const scenarioTitleEl = document.getElementById('scenario-title');
const itemIconEl = document.getElementById('item-icon');
const itemClueEl = document.getElementById('item-clue');
const feedbackMessageEl = document.getElementById('feedback-message');
const scoreDisplayEl = document.getElementById('score-display');
const dictionaryContentEl = document.getElementById('dictionary-content');
const nextButtonEl = document.getElementById('next-button');
const dragItemEl = document.getElementById('drag-item');
const ownerTargets = document.querySelectorAll('.owner-target');

// Estado do Jogo
let currentRound = 0;
let score = 0;
let hintUsedInRound = false; 
let currentCorrectAnswer = '';
let isRoundFinished = false;

// --- Fun√ß√µes de Ajuda ---

function generateIncorrectHint(correctAnswer) {
    const hintData = HINT_MAP[correctAnswer];
    let hint = "";
    
    // Revela o alvo correto em um formato m√≠stico em portugu√™s
    hint += `<div class="mystic-hint" style="border-color: #8A2BE2;"><span>${hintData.emoji}</span>**O ALVO SECRETO √â: ${correctAnswer} (${hintData.pt.split('(')[1]}**</div>`;

    return hint;
}

// --- L√≥gica Drag & Drop ---

function dragStart(e) {
    if (isRoundFinished) return;
    e.dataTransfer.setData('text/plain', dragItemEl.id); 
    e.currentTarget.classList.add('dragging');
}

function dragOver(e) {
    e.preventDefault(); 
    if (e.target.closest('.owner-target')) {
        e.target.closest('.owner-target').classList.add('hovered');
    }
}

function dragLeave(e) {
    if (e.target.closest('.owner-target')) {
        e.target.closest('.owner-target').classList.remove('hovered');
    }
}

function drop(e) {
    e.preventDefault();
    if (isRoundFinished) return;
    
    const droppedTargetEl = e.currentTarget.closest('.owner-target');
    if (!droppedTargetEl) return;
    
    droppedTargetEl.classList.remove('hovered');

    const droppedOwner = droppedTargetEl.dataset.owner;
    checkAnswer(droppedOwner, currentCorrectAnswer, droppedTargetEl);
}

function checkAnswer(droppedOwner, correctOwner, droppedTargetEl) {
    // Desabilita arrastar ap√≥s o primeiro drop
    dragItemEl.setAttribute('draggable', 'false');
    isRoundFinished = true;

    ownerTargets.forEach(target => target.classList.remove('correct-drop', 'incorrect-drop'));

    if (droppedOwner === correctOwner) {
        // CORRETO
        droppedTargetEl.classList.add('correct-drop');
        
        let pointsAwarded = 0;
        if (hintUsedInRound === false) {
            pointsAwarded = 2;
            feedbackMessageEl.textContent = `ENTREGA BEM SUCEDIDA! (2 PONTOS - Acerto de Primeira) O pronome √©: ${correctOwner}.`;
        } else {
            pointsAwarded = 1;
            feedbackMessageEl.textContent = `ENTREGA BEM SUCEDIDA! (1 PONTO - Com Grim√≥rio) O pronome √©: ${correctOwner}.`;
        }
        
        score += pointsAwarded;
        feedbackMessageEl.className = 'feedback-correct';
        scoreDisplayEl.textContent = `Pontos: ${score}`;
        
        // Coloca o item no lugar do dono
        droppedTargetEl.appendChild(dragItemEl);
        dragItemEl.style.position = 'static';
        dragItemEl.style.transform = 'none';

        dictionaryContentEl.innerHTML = `**REGRA:** ${QUIZ_DATA[currentRound].scenario_interpretation}`;
        nextButtonEl.classList.remove('hidden');

    } else {
        // INCORRETO
        droppedTargetEl.classList.add('incorrect-drop');
        
        feedbackMessageEl.textContent = `ERRO NA ENTREGA! O Grim√≥rio se abriu para revelar o Alvo...`;
        feedbackMessageEl.className = 'feedback-incorrect';
        
        // Ativa a flag de dica e revela o alvo (Grim√≥rio)
        hintUsedInRound = true; 
        dictionaryContentEl.innerHTML = generateIncorrectHint(correctOwner);
        
        // Permite tentar novamente ap√≥s 1 segundo
        setTimeout(() => {
            resetTargets();
            dragItemEl.setAttribute('draggable', 'true');
            isRoundFinished = false; 
            droppedTargetEl.classList.remove('incorrect-drop'); 
        }, 1000);
    }
}

function resetTargets() {
    // Retorna o item para o centro do palco
    document.querySelector('.drag-drop-palco').appendChild(dragItemEl);
    dragItemEl.style.position = 'absolute';
    dragItemEl.style.top = '50%';
    dragItemEl.style.left = '50%';
    dragItemEl.style.transform = 'translate(-50%, -50%)';
    dragItemEl.classList.remove('dragging');
    
    // Remove qualquer marca de feedback dos donos
    ownerTargets.forEach(target => target.classList.remove('correct-drop', 'incorrect-drop', 'hovered'));
}


function loadRound() {
    if (currentRound >= QUIZ_DATA.length) {
        endGame();
        return;
    }

    const data = QUIZ_DATA[currentRound];
    
    // 1. Define o Estado
    hintUsedInRound = false; 
    isRoundFinished = false;
    currentCorrectAnswer = data.correct_answer;
    
    // 2. Atualiza UI
    scenarioTitleEl.textContent = `Entrega M√≠stica ${currentRound + 1}/${QUIZ_DATA.length}`;
    itemIconEl.textContent = data.icon;
    itemClueEl.textContent = data.scenario_pt; // Frase em ingl√™s
    
    feedbackMessageEl.textContent = `Arraste o item (${data.icon}) para o dono que a frase indica.`;
    feedbackMessageEl.className = 'feedback-default';
    scoreDisplayEl.textContent = `Pontos: ${score}`;
    dictionaryContentEl.innerHTML = "O pronome correto aparecer√° aqui ap√≥s o primeiro erro."; 
    
    nextButtonEl.classList.add('hidden');
    
    // 3. Reseta e Ativa Drag
    dragItemEl.setAttribute('draggable', 'true');
    resetTargets();
}

function nextRound() {
    currentRound++;
    loadRound();
}

function endGame() {
    scenarioTitleEl.textContent = 'O C√çRCULO EST√Å COMPLETO!';
    itemClueEl.textContent = `Sua pontua√ß√£o final √©: ${score} de ${QUIZ_DATA.length * 2}.`;
    itemIconEl.textContent = '‚ú®';
    
    document.querySelector('.drag-drop-palco').innerHTML = ''; 
    
    nextButtonEl.classList.add('hidden');
    feedbackMessageEl.textContent = 'Reinicie a p√°gina para come√ßar uma nova miss√£o!';
    dictionaryContentEl.innerHTML = 'Fim do Jogo.';
}

// --- Inicializa√ß√£o e Eventos ---

document.addEventListener('DOMContentLoaded', () => {
    // Embaralha as perguntas no in√≠cio do jogo para ter rodadas variadas
    for (let i = QUIZ_DATA.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [QUIZ_DATA[i], QUIZ_DATA[j]] = [QUIZ_DATA[j], QUIZ_DATA[i]];
    }

    loadRound();
    
    ownerTargets.forEach(target => {
        target.addEventListener('dragover', dragOver);
        target.addEventListener('dragleave', dragLeave);
        target.addEventListener('drop', drop);
    });
    
    dragItemEl.addEventListener('dragstart', dragStart);
});

nextButtonEl.addEventListener('click', nextRound);
