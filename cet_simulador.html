<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Custo Efetivo Total (CET)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f4f7f9;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            box-sizing: border-box;
            color: #333;
        }
        .container {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px; /* Largura ajustada */
            margin-top: 20px;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.8em;
        }
        .explanation {
            font-size: 0.95em;
            color: #555;
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 5px solid #0d6efd;
        }
        .explanation p {
            margin: 5px 0;
        }
         .explanation strong {
             color: #0b5ed7;
         }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Duas colunas */
            gap: 20px; /* Espaço entre colunas e linhas */
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .input-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #495057;
            font-size: 0.9em;
        }
         .input-group label small {
             font-weight: normal;
             color: #6c757d;
         }

        .input-group input[type="number"] {
            padding: 10px 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 1em;
            box-sizing: border-box;
            width: 100%;
        }
         /* Remove setas do input number */
        .input-group input[type=number]::-webkit-inner-spin-button,
        .input-group input[type=number]::-webkit-outer-spin-button {
           -webkit-appearance: none;
           margin: 0;
        }
        .input-group input[type=number] {
           -moz-appearance: textfield; /* Firefox */
        }


        #calculate-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            background-color: #198754;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex; /* Para centralizar com grid */
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%; /* Ocupa largura total */
            margin-top: 10px;
            grid-column: 1 / -1; /* Ocupa as duas colunas */
        }
        #calculate-btn:hover {
            background-color: #157347;
        }

        .results-area {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #dee2e6;
            text-align: left;
        }
        .results-area h2 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4em;
        }
        .result-item {
            margin-bottom: 15px;
            font-size: 1.05em;
            background-color: #f8f9fa;
            padding: 12px 18px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
        }
        .result-item strong {
            color: #0d6efd; /* Azul para destacar valor */
        }
        .cet-note {
            margin-top: 20px;
            font-size: 0.9em;
            color: #6c757d;
            text-align: center;
            font-style: italic;
        }
        .hide { display: none !important; }

         /* Responsividade */
         @media (max-width: 600px) {
             .input-grid {
                 grid-template-columns: 1fr; /* Uma coluna em telas menores */
             }
             .container {
                 padding: 20px;
             }
             h1 {
                 font-size: 1.6em;
             }
         }

    </style>
</head>
<body>

    <div class="container">
        <h1><i class="fas fa-calculator"></i> Simulador de Custo Efetivo Total (CET)</h1>

        <div class="explanation">
            <p>O <strong>Custo Efetivo Total (CET)</strong> representa o custo real de um empréstimo ou financiamento.</p>
            <p>Ele inclui não apenas a <strong>taxa de juros nominal</strong>, mas também todas as <strong>tarifas</strong>, <strong>impostos (IOF)</strong>, <strong>seguros</strong> e outras despesas cobradas.</p>
            <p>Este simulador ajuda a visualizar esses custos, calculando a parcela básica e o valor total pago estimado.</p>
        </div>

        <div class="input-grid">
            <div class="input-group">
                <label for="loan-amount">Valor do Empréstimo (R$)</label>
                <input type="number" id="loan-amount" placeholder="Ex: 10000" step="100" min="0">
            </div>
            <div class="input-group">
                <label for="interest-rate">Taxa Juros Nominal (% ao mês)</label>
                <input type="number" id="interest-rate" placeholder="Ex: 1.99" step="0.01" min="0">
            </div>
            <div class="input-group">
                <label for="loan-term">Prazo (meses)</label>
                <input type="number" id="loan-term" placeholder="Ex: 24" step="1" min="1">
            </div>
             <div class="input-group">
                <label for="admin-fees">Outras Tarifas (R$)</label>
                <input type="number" id="admin-fees" placeholder="Ex: 500" value="0" step="10" min="0">
            </div>
            <div class="input-group">
                <label for="iof-amount">IOF Estimado (R$)</label>
                <input type="number" id="iof-amount" placeholder="Ex: 150" value="0" step="1" min="0">
            </div>
            <div class="input-group">
                <label for="insurance-amount">Seguros Totais (R$) <small>(Opcional)</small></label>
                <input type="number" id="insurance-amount" placeholder="Ex: 300" value="0" step="10" min="0">
            </div>

            <button id="calculate-btn"><i class="fas fa-play"></i> Calcular Custos</button>
        </div>

        <div id="results-area" class="results-area hide">
            <h2><i class="fas fa-chart-line"></i> Resultado Estimado</h2>
            <div class="result-item">
                <span>Valor da Parcela (Juros + Amortização):</span>
                <strong id="result-installment">R$ 0,00</strong>
            </div>
             <div class="result-item">
                <span>Custo Total de Juros:</span>
                <strong id="result-total-interest">R$ 0,00</strong>
            </div>
            <div class="result-item">
                <span>Custos Adicionais (Tarifas + IOF + Seguros):</span>
                <strong id="result-additional-costs">R$ 0,00</strong>
            </div>
             <div class="result-item">
                 <span>Custo Total Estimado (Juros + Adicionais):</span>
                 <strong id="result-total-cost">R$ 0,00</strong>
             </div>
            <div class="result-item">
                <span>Valor Total Pago Estimado:</span>
                <strong id="result-total-paid">R$ 0,00</strong>
            </div>
            <p class="cet-note">
                <strong>Nota:</strong> O cálculo da taxa <strong>CET (% a.a.)</strong> exata requer métodos financeiros específicos (TIR). Este simulador demonstra os componentes que formam o custo total do seu empréstimo. Compare sempre o CET ao contratar crédito!
            </p>
        </div>
    </div>

    <script>
        // --- Elementos da UI ---
        const loanAmountInput = document.getElementById('loan-amount');
        const interestRateInput = document.getElementById('interest-rate');
        const loanTermInput = document.getElementById('loan-term');
        const adminFeesInput = document.getElementById('admin-fees');
        const iofAmountInput = document.getElementById('iof-amount');
        const insuranceAmountInput = document.getElementById('insurance-amount');
        const calculateBtn = document.getElementById('calculate-btn');
        const resultsArea = document.getElementById('results-area');
        const resultInstallment = document.getElementById('result-installment');
        const resultTotalInterest = document.getElementById('result-total-interest');
        const resultAdditionalCosts = document.getElementById('result-additional-costs');
        const resultTotalCost = document.getElementById('result-total-cost');
        const resultTotalPaid = document.getElementById('result-total-paid');

        // --- Função para formatar como moeda ---
        function formatCurrency(value) {
             if (isNaN(value) || value === null) {
                 return "R$ ---";
             }
            return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }

        // --- Função de Cálculo PMT (Parcela) ---
        function calculateMonthlyPayment(loanAmount, monthlyRate, termMonths) {
            if (monthlyRate <= 0) { // Se taxa for 0 ou negativa, parcela é simples divisão
                 return loanAmount / termMonths;
            }
            // Fórmula PMT (Tabela Price)
            const i = monthlyRate / 100; // Taxa decimal
            const n = termMonths;
            const factor = Math.pow(1 + i, n);
            const pmt = loanAmount * (i * factor) / (factor - 1);
            return pmt;
        }

        // --- Função Principal de Cálculo e Exibição ---
        function calculateCET() {
            // Obter valores dos inputs
            const loanAmount = parseFloat(loanAmountInput.value) || 0;
            const monthlyRate = parseFloat(interestRateInput.value) || 0;
            const termMonths = parseInt(loanTermInput.value) || 0;
            const adminFees = parseFloat(adminFeesInput.value) || 0;
            const iofAmount = parseFloat(iofAmountInput.value) || 0;
            const insuranceAmount = parseFloat(insuranceAmountInput.value) || 0;

            // Validações básicas
            if (loanAmount <= 0 || monthlyRate < 0 || termMonths <= 0) {
                alert("Por favor, preencha o Valor do Empréstimo, Taxa de Juros (positiva ou zero) e Prazo (positivo).");
                resultsArea.classList.add('hide');
                return;
            }

            // Calcular Parcela (Juros + Amortização)
            const monthlyPayment = calculateMonthlyPayment(loanAmount, monthlyRate, termMonths);

             // Calcular Total Pago apenas de Juros + Amortização
             const totalPaidBase = monthlyPayment * termMonths;

             // Calcular Custo Total de Juros
             const totalInterest = totalPaidBase - loanAmount;

            // Calcular Custos Adicionais
            const additionalCosts = adminFees + iofAmount + insuranceAmount;

            // Calcular Custo Total Estimado
            const totalCost = totalInterest + additionalCosts;

             // Calcular Valor Total Pago Estimado
             const totalPaid = loanAmount + totalCost; // Ou totalPaidBase + additionalCosts

            // Exibir Resultados
            resultInstallment.textContent = formatCurrency(monthlyPayment);
            resultTotalInterest.textContent = formatCurrency(totalInterest > 0 ? totalInterest : 0); // Evita juros negativos
            resultAdditionalCosts.textContent = formatCurrency(additionalCosts);
            resultTotalCost.textContent = formatCurrency(totalCost > 0 ? totalCost : 0);
            resultTotalPaid.textContent = formatCurrency(totalPaid);

            resultsArea.classList.remove('hide'); // Mostra a área de resultados
        }

        // --- Event Listener ---
        calculateBtn.addEventListener('click', calculateCET);

        // Adiciona listeners para Enter nos inputs
        [loanAmountInput, interestRateInput, loanTermInput, adminFeesInput, iofAmountInput, insuranceAmountInput].forEach(input => {
             input.addEventListener('keypress', (e) => {
                 if (e.key === 'Enter') {
                     calculateCET();
                 }
             });
        });

        // --- Inicialização (Opcional) ---
        // Poderia preencher com valores de exemplo se quisesse
        // loanAmountInput.value = 10000;
        // interestRateInput.value = 1.99;
        // loanTermInput.value = 24;

    </script>

</body>
</html>
